# Кэширующий DNS-сервер на Python

Этот проект представляет собой простой кэширующий DNS-сервер, реализованный на Python. Сервер принимает входящие DNS-запросы, если нужная информация отсутствует в кэше – пересылает запрос на удалённый DNS-сервер, сохраняет полученный ответ (с учетом TTL) и возвращает его клиенту. При последующих запросах данные выдаются из кэша до истечения срока их жизни.

---

## Что это и для чего нужно

DNS-сервер преобразует доменные имена в IP-адреса.
- **Разбирает** входящие DNS-пакеты, извлекает заголовок, вопрос и записи ответа.
- **Кэширует** полученные записи с учетом их времени жизни (TTL)
- **Пересылает** запросы, если нужная информация отсутствует в кэше, на удалённый DNS-сервер (здесь Google DNS или любой другой).

---

# Класс DNSRecord: формирование ресурса (ответа) DNS-записи в бинарном формате
# Класс DNSCacheStorage: реализация кэширования с учетом TTL с сохранением в файл
# Класс DNSRequest: представление DNS-запроса, его параметры и исходный формат
# Основной модуль: парсинг входящего пакета, работа с кэшем, обращение к удалённому серверу и отправка ответа

- **Парсинг запроса и ответа:**  
  Функции и классы в модуле `dns_engine.py` разбирают входящий UDP-пакет, извлекая заголовок, вопрос и, если есть, записи ответов.

- **Формирование записей:**  
  Класс `DNSRecord` (файл `dns_record.py`) отвечает за построение бинарного представления DNS-ответной записи (Resource Record).

- **Кэширование:**  
  Класс `DNSCacheStorage` (файл `dns_storage.py`) хранит полученные записи в словаре, где ключ – домен, а значение – записи по типу, помеченные временем истечения (TTL). Кэш сохраняется с помощью `pickle` в файл (например, `cache_data.p`), что позволяет восстанавливать данные при перезапуске сервера.

- **Отправка запроса к удалённому серверу:**  
  Если нужный ответ отсутствует в кэше, функция `fetch_remote_dns` из модуля `constants.py` отправляет сформированный DNS-пакет на удалённый DNS-сервер (например, на `8.8.8.8:53`) и ждет ответа.

- **Запуск сервера:**  
  Основной цикл в файле `dns_engine.py` ожидает входящие UDP-пакеты, анализирует их, проверяет наличие ответа в кэше и, если необходимо, пересылает запрос на внешний сервер. Полученный ответ парсится для обновления кэша и отправляется клиенту.

---

## Запуск сервера

```python
sudo python3 dns_engine.py
```